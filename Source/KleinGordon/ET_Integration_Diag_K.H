#ifndef ET_INTEGRATION_DIAG_K_H
#define ET_INTEGRATION_DIAG_K_H

#include <AMReX_REAL.H> 
#include <AMReX_Array4.H> 
#include <ET_Integration_Setup_K.H> 

AMREX_GPU_DEVICE 
inline 
void 
state_diagnostics(int i, int j, int k, 
        amrex::Array4<amrex::Real> const& diag, 
        amrex::Array4<amrex::Real const> const& state_fab,
        const amrex::Real time_lev,
        amrex::GpuArray<amrex::Real,AMREX_SPACEDIM> const& dx, 
        const amrex::GeometryData& geom) noexcept 
{
        const auto domain_xlo = geom.ProbLo();
        
        amrex::Real x_U_0 = (i + 0.5)*geom.CellSize(0) + domain_xlo[0]; 
        amrex::Real x_U_1 = (j + 0.5)*geom.CellSize(1) + domain_xlo[1];
        amrex::Real x_U_2 = (k + 0.5)*geom.CellSize(2) + domain_xlo[2];
        
        amrex::Real v = 0.050000000000000003;
        
        amrex::Real phi1 = state_fab(i, j, k, Idx::Phi1);

        amrex::Real phi2 = state_fab(i, j, k, Idx::Phi2);
        
        amrex::Real AbsPhi = v*v - 1.0/2.0*(phi1*phi1 + phi2*phi2);
        
        diag(i, j, k, Diag::AbsPhi) = AbsPhi;
        
        amrex::Real KOSigma = 0; //0.32000000000000001;

        amrex::Real lambda = 2.0;

        amrex::Real echarge = 1.0;

        amrex::Real kappa1 = 0.02;

        amrex::Real kappa2 = 0;

        amrex::Real eta = 0.25;

        amrex::Real kappaEM = 0.01;

        amrex::Real E_U_0 = state_fab(i, j, k, Idx::E_U_0);
        amrex::Real E_U_1 = state_fab(i, j, k, Idx::E_U_1);
        amrex::Real E_U_2 = state_fab(i, j, k, Idx::E_U_2);

        amrex::Real A = state_fab(i, j, k, Idx::A);

        amrex::Real A_L_0 = state_fab(i, j, k, Idx::A_L_0);
        amrex::Real A_L_1 = state_fab(i, j, k, Idx::A_L_1);
        amrex::Real A_L_2 = state_fab(i, j, k, Idx::A_L_2);

        amrex::Real Z = state_fab(i, j, k, Idx::Z);

        amrex::Real Phi1 = state_fab(i, j, k, Idx::Phi1);

        amrex::Real Phi2 = state_fab(i, j, k, Idx::Phi2);

        amrex::Real Pi1 = state_fab(i, j, k, Idx::Pi1);

        amrex::Real Pi2 = state_fab(i, j, k, Idx::Pi2);

        amrex::Real dDE_UL_00 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::E_U_0) - 1.0/12.0*state_fab(i + 2, j, k, Idx::E_U_0) - 2.0/3.0*state_fab(i - 1, j, k, Idx::E_U_0) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::E_U_0))/dx[0];
        amrex::Real dDE_UL_01 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::E_U_0) - 1.0/12.0*state_fab(i, j + 2, k, Idx::E_U_0) - 2.0/3.0*state_fab(i, j - 1, k, Idx::E_U_0) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::E_U_0))/dx[1];
        amrex::Real dDE_UL_02 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::E_U_0) - 1.0/12.0*state_fab(i, j, k + 2, Idx::E_U_0) - 2.0/3.0*state_fab(i, j, k - 1, Idx::E_U_0) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::E_U_0))/dx[2];
        amrex::Real dDE_UL_10 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::E_U_1) - 1.0/12.0*state_fab(i + 2, j, k, Idx::E_U_1) - 2.0/3.0*state_fab(i - 1, j, k, Idx::E_U_1) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::E_U_1))/dx[0];
        amrex::Real dDE_UL_11 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::E_U_1) - 1.0/12.0*state_fab(i, j + 2, k, Idx::E_U_1) - 2.0/3.0*state_fab(i, j - 1, k, Idx::E_U_1) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::E_U_1))/dx[1];
        amrex::Real dDE_UL_12 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::E_U_1) - 1.0/12.0*state_fab(i, j, k + 2, Idx::E_U_1) - 2.0/3.0*state_fab(i, j, k - 1, Idx::E_U_1) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::E_U_1))/dx[2];
        amrex::Real dDE_UL_20 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::E_U_2) - 1.0/12.0*state_fab(i + 2, j, k, Idx::E_U_2) - 2.0/3.0*state_fab(i - 1, j, k, Idx::E_U_2) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::E_U_2))/dx[0];
        amrex::Real dDE_UL_21 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::E_U_2) - 1.0/12.0*state_fab(i, j + 2, k, Idx::E_U_2) - 2.0/3.0*state_fab(i, j - 1, k, Idx::E_U_2) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::E_U_2))/dx[1];
        amrex::Real dDE_UL_22 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::E_U_2) - 1.0/12.0*state_fab(i, j, k + 2, Idx::E_U_2) - 2.0/3.0*state_fab(i, j, k - 1, Idx::E_U_2) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::E_U_2))/dx[2];

        amrex::Real dDDE_ULL_000 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::E_U_0) - 1.0/12.0*state_fab(i + 2, j, k, Idx::E_U_0) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::E_U_0) - 1.0/12.0*state_fab(i - 2, j, k, Idx::E_U_0) - 5.0/2.0*state_fab(i, j, k, Idx::E_U_0))/std::pow(dx[0], 2);
        amrex::Real dDDE_ULL_001 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::E_U_0) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::E_U_0) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::E_U_0) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::E_U_0) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::E_U_0) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::E_U_0) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::E_U_0) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::E_U_0) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::E_U_0) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::E_U_0) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::E_U_0) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::E_U_0) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::E_U_0) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::E_U_0) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::E_U_0) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::E_U_0))/(dx[0]*dx[1]);
        amrex::Real dDDE_ULL_002 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::E_U_0) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::E_U_0) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::E_U_0) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::E_U_0) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::E_U_0) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::E_U_0) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::E_U_0) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::E_U_0) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::E_U_0) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::E_U_0) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::E_U_0) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::E_U_0) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::E_U_0) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::E_U_0) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::E_U_0) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::E_U_0))/(dx[0]*dx[2]);
        amrex::Real dDDE_ULL_011 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::E_U_0) - 1.0/12.0*state_fab(i, j + 2, k, Idx::E_U_0) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::E_U_0) - 1.0/12.0*state_fab(i, j - 2, k, Idx::E_U_0) - 5.0/2.0*state_fab(i, j, k, Idx::E_U_0))/std::pow(dx[1], 2);
        amrex::Real dDDE_ULL_012 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::E_U_0) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::E_U_0) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::E_U_0) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::E_U_0) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::E_U_0) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::E_U_0) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::E_U_0) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::E_U_0) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::E_U_0) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::E_U_0) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::E_U_0) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::E_U_0) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::E_U_0) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::E_U_0) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::E_U_0) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::E_U_0))/(dx[1]*dx[2]);
        amrex::Real dDDE_ULL_022 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::E_U_0) - 1.0/12.0*state_fab(i, j, k + 2, Idx::E_U_0) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::E_U_0) - 1.0/12.0*state_fab(i, j, k - 2, Idx::E_U_0) - 5.0/2.0*state_fab(i, j, k, Idx::E_U_0))/std::pow(dx[2], 2);
        amrex::Real dDDE_ULL_100 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::E_U_1) - 1.0/12.0*state_fab(i + 2, j, k, Idx::E_U_1) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::E_U_1) - 1.0/12.0*state_fab(i - 2, j, k, Idx::E_U_1) - 5.0/2.0*state_fab(i, j, k, Idx::E_U_1))/std::pow(dx[0], 2);
        amrex::Real dDDE_ULL_101 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::E_U_1) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::E_U_1) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::E_U_1) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::E_U_1) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::E_U_1) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::E_U_1) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::E_U_1) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::E_U_1) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::E_U_1) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::E_U_1) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::E_U_1) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::E_U_1) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::E_U_1) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::E_U_1) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::E_U_1) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::E_U_1))/(dx[0]*dx[1]);
        amrex::Real dDDE_ULL_102 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::E_U_1) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::E_U_1) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::E_U_1) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::E_U_1) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::E_U_1) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::E_U_1) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::E_U_1) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::E_U_1) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::E_U_1) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::E_U_1) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::E_U_1) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::E_U_1) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::E_U_1) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::E_U_1) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::E_U_1) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::E_U_1))/(dx[0]*dx[2]);
        amrex::Real dDDE_ULL_111 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::E_U_1) - 1.0/12.0*state_fab(i, j + 2, k, Idx::E_U_1) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::E_U_1) - 1.0/12.0*state_fab(i, j - 2, k, Idx::E_U_1) - 5.0/2.0*state_fab(i, j, k, Idx::E_U_1))/std::pow(dx[1], 2);
        amrex::Real dDDE_ULL_112 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::E_U_1) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::E_U_1) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::E_U_1) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::E_U_1) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::E_U_1) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::E_U_1) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::E_U_1) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::E_U_1) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::E_U_1) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::E_U_1) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::E_U_1) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::E_U_1) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::E_U_1) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::E_U_1) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::E_U_1) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::E_U_1))/(dx[1]*dx[2]);
        amrex::Real dDDE_ULL_122 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::E_U_1) - 1.0/12.0*state_fab(i, j, k + 2, Idx::E_U_1) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::E_U_1) - 1.0/12.0*state_fab(i, j, k - 2, Idx::E_U_1) - 5.0/2.0*state_fab(i, j, k, Idx::E_U_1))/std::pow(dx[2], 2);
        amrex::Real dDDE_ULL_200 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::E_U_2) - 1.0/12.0*state_fab(i + 2, j, k, Idx::E_U_2) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::E_U_2) - 1.0/12.0*state_fab(i - 2, j, k, Idx::E_U_2) - 5.0/2.0*state_fab(i, j, k, Idx::E_U_2))/std::pow(dx[0], 2);
        amrex::Real dDDE_ULL_201 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::E_U_2) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::E_U_2) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::E_U_2) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::E_U_2) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::E_U_2) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::E_U_2) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::E_U_2) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::E_U_2) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::E_U_2) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::E_U_2) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::E_U_2) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::E_U_2) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::E_U_2) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::E_U_2) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::E_U_2) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::E_U_2))/(dx[0]*dx[1]);
        amrex::Real dDDE_ULL_202 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::E_U_2) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::E_U_2) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::E_U_2) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::E_U_2) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::E_U_2) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::E_U_2) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::E_U_2) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::E_U_2) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::E_U_2) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::E_U_2) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::E_U_2) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::E_U_2) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::E_U_2) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::E_U_2) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::E_U_2) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::E_U_2))/(dx[0]*dx[2]);
        amrex::Real dDDE_ULL_211 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::E_U_2) - 1.0/12.0*state_fab(i, j + 2, k, Idx::E_U_2) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::E_U_2) - 1.0/12.0*state_fab(i, j - 2, k, Idx::E_U_2) - 5.0/2.0*state_fab(i, j, k, Idx::E_U_2))/std::pow(dx[1], 2);
        amrex::Real dDDE_ULL_212 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::E_U_2) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::E_U_2) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::E_U_2) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::E_U_2) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::E_U_2) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::E_U_2) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::E_U_2) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::E_U_2) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::E_U_2) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::E_U_2) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::E_U_2) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::E_U_2) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::E_U_2) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::E_U_2) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::E_U_2) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::E_U_2))/(dx[1]*dx[2]);
        amrex::Real dDDE_ULL_222 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::E_U_2) - 1.0/12.0*state_fab(i, j, k + 2, Idx::E_U_2) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::E_U_2) - 1.0/12.0*state_fab(i, j, k - 2, Idx::E_U_2) - 5.0/2.0*state_fab(i, j, k, Idx::E_U_2))/std::pow(dx[2], 2);

        amrex::Real dKODE_U_0 = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::E_U_0) - 3.0/32.0*state_fab(i, j, k + 2, Idx::E_U_0) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::E_U_0) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::E_U_0) - 3.0/32.0*state_fab(i, j, k - 2, Idx::E_U_0) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::E_U_0) - 5.0/16.0*state_fab(i, j, k, Idx::E_U_0))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::E_U_0) - 3.0/32.0*state_fab(i, j + 2, k, Idx::E_U_0) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::E_U_0) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::E_U_0) - 3.0/32.0*state_fab(i, j - 2, k, Idx::E_U_0) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::E_U_0) - 5.0/16.0*state_fab(i, j, k, Idx::E_U_0))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::E_U_0) - 3.0/32.0*state_fab(i + 2, j, k, Idx::E_U_0) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::E_U_0) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::E_U_0) - 3.0/32.0*state_fab(i - 2, j, k, Idx::E_U_0) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::E_U_0) - 5.0/16.0*state_fab(i, j, k, Idx::E_U_0))/dx[0];
        amrex::Real dKODE_U_1 = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::E_U_1) - 3.0/32.0*state_fab(i, j, k + 2, Idx::E_U_1) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::E_U_1) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::E_U_1) - 3.0/32.0*state_fab(i, j, k - 2, Idx::E_U_1) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::E_U_1) - 5.0/16.0*state_fab(i, j, k, Idx::E_U_1))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::E_U_1) - 3.0/32.0*state_fab(i, j + 2, k, Idx::E_U_1) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::E_U_1) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::E_U_1) - 3.0/32.0*state_fab(i, j - 2, k, Idx::E_U_1) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::E_U_1) - 5.0/16.0*state_fab(i, j, k, Idx::E_U_1))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::E_U_1) - 3.0/32.0*state_fab(i + 2, j, k, Idx::E_U_1) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::E_U_1) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::E_U_1) - 3.0/32.0*state_fab(i - 2, j, k, Idx::E_U_1) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::E_U_1) - 5.0/16.0*state_fab(i, j, k, Idx::E_U_1))/dx[0];
        amrex::Real dKODE_U_2 = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::E_U_2) - 3.0/32.0*state_fab(i, j, k + 2, Idx::E_U_2) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::E_U_2) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::E_U_2) - 3.0/32.0*state_fab(i, j, k - 2, Idx::E_U_2) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::E_U_2) - 5.0/16.0*state_fab(i, j, k, Idx::E_U_2))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::E_U_2) - 3.0/32.0*state_fab(i, j + 2, k, Idx::E_U_2) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::E_U_2) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::E_U_2) - 3.0/32.0*state_fab(i, j - 2, k, Idx::E_U_2) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::E_U_2) - 5.0/16.0*state_fab(i, j, k, Idx::E_U_2))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::E_U_2) - 3.0/32.0*state_fab(i + 2, j, k, Idx::E_U_2) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::E_U_2) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::E_U_2) - 3.0/32.0*state_fab(i - 2, j, k, Idx::E_U_2) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::E_U_2) - 5.0/16.0*state_fab(i, j, k, Idx::E_U_2))/dx[0];

        amrex::Real dDA_L_0 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::A) - 1.0/12.0*state_fab(i + 2, j, k, Idx::A) - 2.0/3.0*state_fab(i - 1, j, k, Idx::A) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::A))/dx[0];
        amrex::Real dDA_L_1 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::A) - 1.0/12.0*state_fab(i, j + 2, k, Idx::A) - 2.0/3.0*state_fab(i, j - 1, k, Idx::A) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::A))/dx[1];
        amrex::Real dDA_L_2 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::A) - 1.0/12.0*state_fab(i, j, k + 2, Idx::A) - 2.0/3.0*state_fab(i, j, k - 1, Idx::A) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::A))/dx[2];

        amrex::Real dDDA_LL_00 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::A) - 1.0/12.0*state_fab(i + 2, j, k, Idx::A) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::A) - 1.0/12.0*state_fab(i - 2, j, k, Idx::A) - 5.0/2.0*state_fab(i, j, k, Idx::A))/std::pow(dx[0], 2);
        amrex::Real dDDA_LL_01 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::A) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::A) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::A) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::A) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::A) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::A) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::A) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::A) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::A) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::A) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::A) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::A) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::A) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::A) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::A) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::A))/(dx[0]*dx[1]);
        amrex::Real dDDA_LL_02 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::A) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::A) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::A) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::A) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::A) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::A) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::A) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::A) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::A) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::A) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::A) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::A) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::A) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::A) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::A) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::A))/(dx[0]*dx[2]);
        amrex::Real dDDA_LL_11 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::A) - 1.0/12.0*state_fab(i, j + 2, k, Idx::A) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::A) - 1.0/12.0*state_fab(i, j - 2, k, Idx::A) - 5.0/2.0*state_fab(i, j, k, Idx::A))/std::pow(dx[1], 2);
        amrex::Real dDDA_LL_12 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::A) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::A) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::A) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::A) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::A) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::A) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::A) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::A) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::A) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::A) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::A) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::A) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::A) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::A) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::A) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::A))/(dx[1]*dx[2]);
        amrex::Real dDDA_LL_22 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::A) - 1.0/12.0*state_fab(i, j, k + 2, Idx::A) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::A) - 1.0/12.0*state_fab(i, j, k - 2, Idx::A) - 5.0/2.0*state_fab(i, j, k, Idx::A))/std::pow(dx[2], 2);

        amrex::Real dKODA = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::A) - 3.0/32.0*state_fab(i, j, k + 2, Idx::A) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::A) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::A) - 3.0/32.0*state_fab(i, j, k - 2, Idx::A) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::A) - 5.0/16.0*state_fab(i, j, k, Idx::A))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::A) - 3.0/32.0*state_fab(i, j + 2, k, Idx::A) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::A) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::A) - 3.0/32.0*state_fab(i, j - 2, k, Idx::A) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::A) - 5.0/16.0*state_fab(i, j, k, Idx::A))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::A) - 3.0/32.0*state_fab(i + 2, j, k, Idx::A) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::A) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::A) - 3.0/32.0*state_fab(i - 2, j, k, Idx::A) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::A) - 5.0/16.0*state_fab(i, j, k, Idx::A))/dx[0];

        amrex::Real dDA_LL_00 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::A_L_0) - 1.0/12.0*state_fab(i + 2, j, k, Idx::A_L_0) - 2.0/3.0*state_fab(i - 1, j, k, Idx::A_L_0) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::A_L_0))/dx[0];
        amrex::Real dDA_LL_01 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::A_L_0) - 1.0/12.0*state_fab(i, j + 2, k, Idx::A_L_0) - 2.0/3.0*state_fab(i, j - 1, k, Idx::A_L_0) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::A_L_0))/dx[1];
        amrex::Real dDA_LL_02 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::A_L_0) - 1.0/12.0*state_fab(i, j, k + 2, Idx::A_L_0) - 2.0/3.0*state_fab(i, j, k - 1, Idx::A_L_0) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::A_L_0))/dx[2];
        amrex::Real dDA_LL_10 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::A_L_1) - 1.0/12.0*state_fab(i + 2, j, k, Idx::A_L_1) - 2.0/3.0*state_fab(i - 1, j, k, Idx::A_L_1) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::A_L_1))/dx[0];
        amrex::Real dDA_LL_11 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::A_L_1) - 1.0/12.0*state_fab(i, j + 2, k, Idx::A_L_1) - 2.0/3.0*state_fab(i, j - 1, k, Idx::A_L_1) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::A_L_1))/dx[1];
        amrex::Real dDA_LL_12 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::A_L_1) - 1.0/12.0*state_fab(i, j, k + 2, Idx::A_L_1) - 2.0/3.0*state_fab(i, j, k - 1, Idx::A_L_1) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::A_L_1))/dx[2];
        amrex::Real dDA_LL_20 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::A_L_2) - 1.0/12.0*state_fab(i + 2, j, k, Idx::A_L_2) - 2.0/3.0*state_fab(i - 1, j, k, Idx::A_L_2) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::A_L_2))/dx[0];
        amrex::Real dDA_LL_21 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::A_L_2) - 1.0/12.0*state_fab(i, j + 2, k, Idx::A_L_2) - 2.0/3.0*state_fab(i, j - 1, k, Idx::A_L_2) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::A_L_2))/dx[1];
        amrex::Real dDA_LL_22 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::A_L_2) - 1.0/12.0*state_fab(i, j, k + 2, Idx::A_L_2) - 2.0/3.0*state_fab(i, j, k - 1, Idx::A_L_2) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::A_L_2))/dx[2];

        amrex::Real dDDA_LLL_000 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::A_L_0) - 1.0/12.0*state_fab(i + 2, j, k, Idx::A_L_0) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::A_L_0) - 1.0/12.0*state_fab(i - 2, j, k, Idx::A_L_0) - 5.0/2.0*state_fab(i, j, k, Idx::A_L_0))/std::pow(dx[0], 2);
        amrex::Real dDDA_LLL_001 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::A_L_0) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::A_L_0) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::A_L_0) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::A_L_0) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::A_L_0) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::A_L_0) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::A_L_0) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::A_L_0) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::A_L_0) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::A_L_0) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::A_L_0) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::A_L_0) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::A_L_0) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::A_L_0) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::A_L_0) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::A_L_0))/(dx[0]*dx[1]);
        amrex::Real dDDA_LLL_002 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::A_L_0) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::A_L_0) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::A_L_0) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::A_L_0) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::A_L_0) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::A_L_0) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::A_L_0) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::A_L_0) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::A_L_0) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::A_L_0) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::A_L_0) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::A_L_0) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::A_L_0) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::A_L_0) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::A_L_0) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::A_L_0))/(dx[0]*dx[2]);
        amrex::Real dDDA_LLL_011 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::A_L_0) - 1.0/12.0*state_fab(i, j + 2, k, Idx::A_L_0) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::A_L_0) - 1.0/12.0*state_fab(i, j - 2, k, Idx::A_L_0) - 5.0/2.0*state_fab(i, j, k, Idx::A_L_0))/std::pow(dx[1], 2);
        amrex::Real dDDA_LLL_012 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::A_L_0) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::A_L_0) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::A_L_0) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::A_L_0) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::A_L_0) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::A_L_0) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::A_L_0) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::A_L_0) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::A_L_0) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::A_L_0) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::A_L_0) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::A_L_0) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::A_L_0) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::A_L_0) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::A_L_0) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::A_L_0))/(dx[1]*dx[2]);
        amrex::Real dDDA_LLL_022 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::A_L_0) - 1.0/12.0*state_fab(i, j, k + 2, Idx::A_L_0) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::A_L_0) - 1.0/12.0*state_fab(i, j, k - 2, Idx::A_L_0) - 5.0/2.0*state_fab(i, j, k, Idx::A_L_0))/std::pow(dx[2], 2);
        amrex::Real dDDA_LLL_100 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::A_L_1) - 1.0/12.0*state_fab(i + 2, j, k, Idx::A_L_1) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::A_L_1) - 1.0/12.0*state_fab(i - 2, j, k, Idx::A_L_1) - 5.0/2.0*state_fab(i, j, k, Idx::A_L_1))/std::pow(dx[0], 2);
        amrex::Real dDDA_LLL_101 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::A_L_1) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::A_L_1) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::A_L_1) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::A_L_1) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::A_L_1) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::A_L_1) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::A_L_1) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::A_L_1) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::A_L_1) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::A_L_1) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::A_L_1) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::A_L_1) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::A_L_1) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::A_L_1) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::A_L_1) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::A_L_1))/(dx[0]*dx[1]);
        amrex::Real dDDA_LLL_102 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::A_L_1) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::A_L_1) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::A_L_1) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::A_L_1) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::A_L_1) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::A_L_1) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::A_L_1) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::A_L_1) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::A_L_1) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::A_L_1) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::A_L_1) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::A_L_1) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::A_L_1) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::A_L_1) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::A_L_1) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::A_L_1))/(dx[0]*dx[2]);
        amrex::Real dDDA_LLL_111 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::A_L_1) - 1.0/12.0*state_fab(i, j + 2, k, Idx::A_L_1) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::A_L_1) - 1.0/12.0*state_fab(i, j - 2, k, Idx::A_L_1) - 5.0/2.0*state_fab(i, j, k, Idx::A_L_1))/std::pow(dx[1], 2);
        amrex::Real dDDA_LLL_112 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::A_L_1) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::A_L_1) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::A_L_1) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::A_L_1) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::A_L_1) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::A_L_1) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::A_L_1) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::A_L_1) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::A_L_1) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::A_L_1) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::A_L_1) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::A_L_1) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::A_L_1) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::A_L_1) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::A_L_1) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::A_L_1))/(dx[1]*dx[2]);
        amrex::Real dDDA_LLL_122 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::A_L_1) - 1.0/12.0*state_fab(i, j, k + 2, Idx::A_L_1) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::A_L_1) - 1.0/12.0*state_fab(i, j, k - 2, Idx::A_L_1) - 5.0/2.0*state_fab(i, j, k, Idx::A_L_1))/std::pow(dx[2], 2);
        amrex::Real dDDA_LLL_200 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::A_L_2) - 1.0/12.0*state_fab(i + 2, j, k, Idx::A_L_2) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::A_L_2) - 1.0/12.0*state_fab(i - 2, j, k, Idx::A_L_2) - 5.0/2.0*state_fab(i, j, k, Idx::A_L_2))/std::pow(dx[0], 2);
        amrex::Real dDDA_LLL_201 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::A_L_2) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::A_L_2) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::A_L_2) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::A_L_2) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::A_L_2) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::A_L_2) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::A_L_2) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::A_L_2) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::A_L_2) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::A_L_2) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::A_L_2) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::A_L_2) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::A_L_2) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::A_L_2) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::A_L_2) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::A_L_2))/(dx[0]*dx[1]);
        amrex::Real dDDA_LLL_202 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::A_L_2) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::A_L_2) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::A_L_2) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::A_L_2) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::A_L_2) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::A_L_2) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::A_L_2) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::A_L_2) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::A_L_2) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::A_L_2) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::A_L_2) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::A_L_2) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::A_L_2) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::A_L_2) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::A_L_2) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::A_L_2))/(dx[0]*dx[2]);
        amrex::Real dDDA_LLL_211 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::A_L_2) - 1.0/12.0*state_fab(i, j + 2, k, Idx::A_L_2) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::A_L_2) - 1.0/12.0*state_fab(i, j - 2, k, Idx::A_L_2) - 5.0/2.0*state_fab(i, j, k, Idx::A_L_2))/std::pow(dx[1], 2);
        amrex::Real dDDA_LLL_212 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::A_L_2) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::A_L_2) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::A_L_2) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::A_L_2) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::A_L_2) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::A_L_2) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::A_L_2) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::A_L_2) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::A_L_2) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::A_L_2) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::A_L_2) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::A_L_2) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::A_L_2) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::A_L_2) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::A_L_2) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::A_L_2))/(dx[1]*dx[2]);
        amrex::Real dDDA_LLL_222 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::A_L_2) - 1.0/12.0*state_fab(i, j, k + 2, Idx::A_L_2) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::A_L_2) - 1.0/12.0*state_fab(i, j, k - 2, Idx::A_L_2) - 5.0/2.0*state_fab(i, j, k, Idx::A_L_2))/std::pow(dx[2], 2);

        amrex::Real dKODA_L_0 = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::A_L_0) - 3.0/32.0*state_fab(i, j, k + 2, Idx::A_L_0) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::A_L_0) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::A_L_0) - 3.0/32.0*state_fab(i, j, k - 2, Idx::A_L_0) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::A_L_0) - 5.0/16.0*state_fab(i, j, k, Idx::A_L_0))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::A_L_0) - 3.0/32.0*state_fab(i, j + 2, k, Idx::A_L_0) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::A_L_0) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::A_L_0) - 3.0/32.0*state_fab(i, j - 2, k, Idx::A_L_0) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::A_L_0) - 5.0/16.0*state_fab(i, j, k, Idx::A_L_0))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::A_L_0) - 3.0/32.0*state_fab(i + 2, j, k, Idx::A_L_0) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::A_L_0) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::A_L_0) - 3.0/32.0*state_fab(i - 2, j, k, Idx::A_L_0) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::A_L_0) - 5.0/16.0*state_fab(i, j, k, Idx::A_L_0))/dx[0];
        amrex::Real dKODA_L_1 = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::A_L_1) - 3.0/32.0*state_fab(i, j, k + 2, Idx::A_L_1) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::A_L_1) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::A_L_1) - 3.0/32.0*state_fab(i, j, k - 2, Idx::A_L_1) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::A_L_1) - 5.0/16.0*state_fab(i, j, k, Idx::A_L_1))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::A_L_1) - 3.0/32.0*state_fab(i, j + 2, k, Idx::A_L_1) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::A_L_1) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::A_L_1) - 3.0/32.0*state_fab(i, j - 2, k, Idx::A_L_1) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::A_L_1) - 5.0/16.0*state_fab(i, j, k, Idx::A_L_1))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::A_L_1) - 3.0/32.0*state_fab(i + 2, j, k, Idx::A_L_1) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::A_L_1) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::A_L_1) - 3.0/32.0*state_fab(i - 2, j, k, Idx::A_L_1) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::A_L_1) - 5.0/16.0*state_fab(i, j, k, Idx::A_L_1))/dx[0];
        amrex::Real dKODA_L_2 = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::A_L_2) - 3.0/32.0*state_fab(i, j, k + 2, Idx::A_L_2) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::A_L_2) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::A_L_2) - 3.0/32.0*state_fab(i, j, k - 2, Idx::A_L_2) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::A_L_2) - 5.0/16.0*state_fab(i, j, k, Idx::A_L_2))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::A_L_2) - 3.0/32.0*state_fab(i, j + 2, k, Idx::A_L_2) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::A_L_2) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::A_L_2) - 3.0/32.0*state_fab(i, j - 2, k, Idx::A_L_2) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::A_L_2) - 5.0/16.0*state_fab(i, j, k, Idx::A_L_2))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::A_L_2) - 3.0/32.0*state_fab(i + 2, j, k, Idx::A_L_2) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::A_L_2) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::A_L_2) - 3.0/32.0*state_fab(i - 2, j, k, Idx::A_L_2) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::A_L_2) - 5.0/16.0*state_fab(i, j, k, Idx::A_L_2))/dx[0];

        amrex::Real dDZ_L_0 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::Z) - 1.0/12.0*state_fab(i + 2, j, k, Idx::Z) - 2.0/3.0*state_fab(i - 1, j, k, Idx::Z) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::Z))/dx[0];
        amrex::Real dDZ_L_1 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::Z) - 1.0/12.0*state_fab(i, j + 2, k, Idx::Z) - 2.0/3.0*state_fab(i, j - 1, k, Idx::Z) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::Z))/dx[1];
        amrex::Real dDZ_L_2 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::Z) - 1.0/12.0*state_fab(i, j, k + 2, Idx::Z) - 2.0/3.0*state_fab(i, j, k - 1, Idx::Z) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::Z))/dx[2];

        amrex::Real dDDZ_LL_00 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::Z) - 1.0/12.0*state_fab(i + 2, j, k, Idx::Z) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::Z) - 1.0/12.0*state_fab(i - 2, j, k, Idx::Z) - 5.0/2.0*state_fab(i, j, k, Idx::Z))/std::pow(dx[0], 2);
        amrex::Real dDDZ_LL_01 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::Z) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::Z) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::Z) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::Z) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::Z) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::Z) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::Z) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::Z) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::Z) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::Z) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::Z) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::Z) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::Z) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::Z) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::Z) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::Z))/(dx[0]*dx[1]);
        amrex::Real dDDZ_LL_02 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::Z) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::Z) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::Z) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::Z) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::Z) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::Z) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::Z) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::Z) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::Z) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::Z) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::Z) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::Z) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::Z) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::Z) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::Z) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::Z))/(dx[0]*dx[2]);
        amrex::Real dDDZ_LL_11 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::Z) - 1.0/12.0*state_fab(i, j + 2, k, Idx::Z) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::Z) - 1.0/12.0*state_fab(i, j - 2, k, Idx::Z) - 5.0/2.0*state_fab(i, j, k, Idx::Z))/std::pow(dx[1], 2);
        amrex::Real dDDZ_LL_12 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::Z) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::Z) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::Z) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::Z) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::Z) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::Z) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::Z) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::Z) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::Z) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::Z) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::Z) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::Z) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::Z) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::Z) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::Z) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::Z))/(dx[1]*dx[2]);
        amrex::Real dDDZ_LL_22 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::Z) - 1.0/12.0*state_fab(i, j, k + 2, Idx::Z) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::Z) - 1.0/12.0*state_fab(i, j, k - 2, Idx::Z) - 5.0/2.0*state_fab(i, j, k, Idx::Z))/std::pow(dx[2], 2);

        amrex::Real dKODZ = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::Z) - 3.0/32.0*state_fab(i, j, k + 2, Idx::Z) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::Z) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::Z) - 3.0/32.0*state_fab(i, j, k - 2, Idx::Z) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::Z) - 5.0/16.0*state_fab(i, j, k, Idx::Z))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::Z) - 3.0/32.0*state_fab(i, j + 2, k, Idx::Z) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::Z) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::Z) - 3.0/32.0*state_fab(i, j - 2, k, Idx::Z) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::Z) - 5.0/16.0*state_fab(i, j, k, Idx::Z))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::Z) - 3.0/32.0*state_fab(i + 2, j, k, Idx::Z) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::Z) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::Z) - 3.0/32.0*state_fab(i - 2, j, k, Idx::Z) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::Z) - 5.0/16.0*state_fab(i, j, k, Idx::Z))/dx[0];

        amrex::Real dDPhi1_L_0 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::Phi1) - 1.0/12.0*state_fab(i + 2, j, k, Idx::Phi1) - 2.0/3.0*state_fab(i - 1, j, k, Idx::Phi1) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::Phi1))/dx[0];
        amrex::Real dDPhi1_L_1 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::Phi1) - 1.0/12.0*state_fab(i, j + 2, k, Idx::Phi1) - 2.0/3.0*state_fab(i, j - 1, k, Idx::Phi1) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::Phi1))/dx[1];
        amrex::Real dDPhi1_L_2 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::Phi1) - 1.0/12.0*state_fab(i, j, k + 2, Idx::Phi1) - 2.0/3.0*state_fab(i, j, k - 1, Idx::Phi1) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::Phi1))/dx[2];

        amrex::Real dDDPhi1_LL_00 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::Phi1) - 1.0/12.0*state_fab(i + 2, j, k, Idx::Phi1) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::Phi1) - 1.0/12.0*state_fab(i - 2, j, k, Idx::Phi1) - 5.0/2.0*state_fab(i, j, k, Idx::Phi1))/std::pow(dx[0], 2);
        amrex::Real dDDPhi1_LL_01 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::Phi1) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::Phi1) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::Phi1) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::Phi1) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::Phi1) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::Phi1) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::Phi1) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::Phi1) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::Phi1) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::Phi1) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::Phi1) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::Phi1) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::Phi1) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::Phi1) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::Phi1) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::Phi1))/(dx[0]*dx[1]);
        amrex::Real dDDPhi1_LL_02 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::Phi1) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::Phi1) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::Phi1) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::Phi1) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::Phi1) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::Phi1) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::Phi1) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::Phi1) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::Phi1) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::Phi1) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::Phi1) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::Phi1) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::Phi1) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::Phi1) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::Phi1) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::Phi1))/(dx[0]*dx[2]);
        amrex::Real dDDPhi1_LL_11 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::Phi1) - 1.0/12.0*state_fab(i, j + 2, k, Idx::Phi1) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::Phi1) - 1.0/12.0*state_fab(i, j - 2, k, Idx::Phi1) - 5.0/2.0*state_fab(i, j, k, Idx::Phi1))/std::pow(dx[1], 2);
        amrex::Real dDDPhi1_LL_12 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::Phi1) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::Phi1) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::Phi1) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::Phi1) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::Phi1) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::Phi1) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::Phi1) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::Phi1) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::Phi1) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::Phi1) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::Phi1) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::Phi1) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::Phi1) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::Phi1) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::Phi1) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::Phi1))/(dx[1]*dx[2]);
        amrex::Real dDDPhi1_LL_22 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::Phi1) - 1.0/12.0*state_fab(i, j, k + 2, Idx::Phi1) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::Phi1) - 1.0/12.0*state_fab(i, j, k - 2, Idx::Phi1) - 5.0/2.0*state_fab(i, j, k, Idx::Phi1))/std::pow(dx[2], 2);

        amrex::Real dKODPhi1 = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::Phi1) - 3.0/32.0*state_fab(i, j, k + 2, Idx::Phi1) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::Phi1) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::Phi1) - 3.0/32.0*state_fab(i, j, k - 2, Idx::Phi1) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::Phi1) - 5.0/16.0*state_fab(i, j, k, Idx::Phi1))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::Phi1) - 3.0/32.0*state_fab(i, j + 2, k, Idx::Phi1) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::Phi1) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::Phi1) - 3.0/32.0*state_fab(i, j - 2, k, Idx::Phi1) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::Phi1) - 5.0/16.0*state_fab(i, j, k, Idx::Phi1))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::Phi1) - 3.0/32.0*state_fab(i + 2, j, k, Idx::Phi1) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::Phi1) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::Phi1) - 3.0/32.0*state_fab(i - 2, j, k, Idx::Phi1) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::Phi1) - 5.0/16.0*state_fab(i, j, k, Idx::Phi1))/dx[0];

        amrex::Real dDPhi2_L_0 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::Phi2) - 1.0/12.0*state_fab(i + 2, j, k, Idx::Phi2) - 2.0/3.0*state_fab(i - 1, j, k, Idx::Phi2) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::Phi2))/dx[0];
        amrex::Real dDPhi2_L_1 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::Phi2) - 1.0/12.0*state_fab(i, j + 2, k, Idx::Phi2) - 2.0/3.0*state_fab(i, j - 1, k, Idx::Phi2) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::Phi2))/dx[1];
        amrex::Real dDPhi2_L_2 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::Phi2) - 1.0/12.0*state_fab(i, j, k + 2, Idx::Phi2) - 2.0/3.0*state_fab(i, j, k - 1, Idx::Phi2) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::Phi2))/dx[2];

        amrex::Real dDDPhi2_LL_00 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::Phi2) - 1.0/12.0*state_fab(i + 2, j, k, Idx::Phi2) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::Phi2) - 1.0/12.0*state_fab(i - 2, j, k, Idx::Phi2) - 5.0/2.0*state_fab(i, j, k, Idx::Phi2))/std::pow(dx[0], 2);
        amrex::Real dDDPhi2_LL_01 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::Phi2) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::Phi2) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::Phi2) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::Phi2) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::Phi2) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::Phi2) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::Phi2) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::Phi2) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::Phi2) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::Phi2) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::Phi2) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::Phi2) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::Phi2) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::Phi2) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::Phi2) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::Phi2))/(dx[0]*dx[1]);
        amrex::Real dDDPhi2_LL_02 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::Phi2) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::Phi2) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::Phi2) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::Phi2) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::Phi2) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::Phi2) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::Phi2) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::Phi2) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::Phi2) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::Phi2) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::Phi2) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::Phi2) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::Phi2) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::Phi2) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::Phi2) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::Phi2))/(dx[0]*dx[2]);
        amrex::Real dDDPhi2_LL_11 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::Phi2) - 1.0/12.0*state_fab(i, j + 2, k, Idx::Phi2) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::Phi2) - 1.0/12.0*state_fab(i, j - 2, k, Idx::Phi2) - 5.0/2.0*state_fab(i, j, k, Idx::Phi2))/std::pow(dx[1], 2);
        amrex::Real dDDPhi2_LL_12 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::Phi2) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::Phi2) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::Phi2) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::Phi2) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::Phi2) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::Phi2) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::Phi2) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::Phi2) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::Phi2) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::Phi2) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::Phi2) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::Phi2) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::Phi2) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::Phi2) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::Phi2) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::Phi2))/(dx[1]*dx[2]);
        amrex::Real dDDPhi2_LL_22 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::Phi2) - 1.0/12.0*state_fab(i, j, k + 2, Idx::Phi2) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::Phi2) - 1.0/12.0*state_fab(i, j, k - 2, Idx::Phi2) - 5.0/2.0*state_fab(i, j, k, Idx::Phi2))/std::pow(dx[2], 2);

        amrex::Real dKODPhi2 = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::Phi2) - 3.0/32.0*state_fab(i, j, k + 2, Idx::Phi2) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::Phi2) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::Phi2) - 3.0/32.0*state_fab(i, j, k - 2, Idx::Phi2) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::Phi2) - 5.0/16.0*state_fab(i, j, k, Idx::Phi2))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::Phi2) - 3.0/32.0*state_fab(i, j + 2, k, Idx::Phi2) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::Phi2) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::Phi2) - 3.0/32.0*state_fab(i, j - 2, k, Idx::Phi2) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::Phi2) - 5.0/16.0*state_fab(i, j, k, Idx::Phi2))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::Phi2) - 3.0/32.0*state_fab(i + 2, j, k, Idx::Phi2) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::Phi2) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::Phi2) - 3.0/32.0*state_fab(i - 2, j, k, Idx::Phi2) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::Phi2) - 5.0/16.0*state_fab(i, j, k, Idx::Phi2))/dx[0];

        amrex::Real dDPi1_L_0 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::Pi1) - 1.0/12.0*state_fab(i + 2, j, k, Idx::Pi1) - 2.0/3.0*state_fab(i - 1, j, k, Idx::Pi1) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::Pi1))/dx[0];
        amrex::Real dDPi1_L_1 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::Pi1) - 1.0/12.0*state_fab(i, j + 2, k, Idx::Pi1) - 2.0/3.0*state_fab(i, j - 1, k, Idx::Pi1) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::Pi1))/dx[1];
        amrex::Real dDPi1_L_2 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::Pi1) - 1.0/12.0*state_fab(i, j, k + 2, Idx::Pi1) - 2.0/3.0*state_fab(i, j, k - 1, Idx::Pi1) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::Pi1))/dx[2];

        amrex::Real dDDPi1_LL_00 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::Pi1) - 1.0/12.0*state_fab(i + 2, j, k, Idx::Pi1) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::Pi1) - 1.0/12.0*state_fab(i - 2, j, k, Idx::Pi1) - 5.0/2.0*state_fab(i, j, k, Idx::Pi1))/std::pow(dx[0], 2);
        amrex::Real dDDPi1_LL_01 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::Pi1) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::Pi1) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::Pi1) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::Pi1) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::Pi1) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::Pi1) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::Pi1) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::Pi1) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::Pi1) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::Pi1) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::Pi1) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::Pi1) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::Pi1) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::Pi1) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::Pi1) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::Pi1))/(dx[0]*dx[1]);
        amrex::Real dDDPi1_LL_02 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::Pi1) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::Pi1) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::Pi1) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::Pi1) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::Pi1) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::Pi1) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::Pi1) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::Pi1) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::Pi1) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::Pi1) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::Pi1) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::Pi1) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::Pi1) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::Pi1) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::Pi1) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::Pi1))/(dx[0]*dx[2]);
        amrex::Real dDDPi1_LL_11 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::Pi1) - 1.0/12.0*state_fab(i, j + 2, k, Idx::Pi1) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::Pi1) - 1.0/12.0*state_fab(i, j - 2, k, Idx::Pi1) - 5.0/2.0*state_fab(i, j, k, Idx::Pi1))/std::pow(dx[1], 2);
        amrex::Real dDDPi1_LL_12 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::Pi1) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::Pi1) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::Pi1) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::Pi1) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::Pi1) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::Pi1) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::Pi1) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::Pi1) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::Pi1) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::Pi1) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::Pi1) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::Pi1) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::Pi1) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::Pi1) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::Pi1) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::Pi1))/(dx[1]*dx[2]);
        amrex::Real dDDPi1_LL_22 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::Pi1) - 1.0/12.0*state_fab(i, j, k + 2, Idx::Pi1) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::Pi1) - 1.0/12.0*state_fab(i, j, k - 2, Idx::Pi1) - 5.0/2.0*state_fab(i, j, k, Idx::Pi1))/std::pow(dx[2], 2);

        amrex::Real dKODPi1 = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::Pi1) - 3.0/32.0*state_fab(i, j, k + 2, Idx::Pi1) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::Pi1) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::Pi1) - 3.0/32.0*state_fab(i, j, k - 2, Idx::Pi1) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::Pi1) - 5.0/16.0*state_fab(i, j, k, Idx::Pi1))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::Pi1) - 3.0/32.0*state_fab(i, j + 2, k, Idx::Pi1) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::Pi1) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::Pi1) - 3.0/32.0*state_fab(i, j - 2, k, Idx::Pi1) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::Pi1) - 5.0/16.0*state_fab(i, j, k, Idx::Pi1))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::Pi1) - 3.0/32.0*state_fab(i + 2, j, k, Idx::Pi1) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::Pi1) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::Pi1) - 3.0/32.0*state_fab(i - 2, j, k, Idx::Pi1) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::Pi1) - 5.0/16.0*state_fab(i, j, k, Idx::Pi1))/dx[0];

        amrex::Real dDPi2_L_0 = ((2.0/3.0)*state_fab(i + 1, j, k, Idx::Pi2) - 1.0/12.0*state_fab(i + 2, j, k, Idx::Pi2) - 2.0/3.0*state_fab(i - 1, j, k, Idx::Pi2) + (1.0/12.0)*state_fab(i - 2, j, k, Idx::Pi2))/dx[0];
        amrex::Real dDPi2_L_1 = ((2.0/3.0)*state_fab(i, j + 1, k, Idx::Pi2) - 1.0/12.0*state_fab(i, j + 2, k, Idx::Pi2) - 2.0/3.0*state_fab(i, j - 1, k, Idx::Pi2) + (1.0/12.0)*state_fab(i, j - 2, k, Idx::Pi2))/dx[1];
        amrex::Real dDPi2_L_2 = ((2.0/3.0)*state_fab(i, j, k + 1, Idx::Pi2) - 1.0/12.0*state_fab(i, j, k + 2, Idx::Pi2) - 2.0/3.0*state_fab(i, j, k - 1, Idx::Pi2) + (1.0/12.0)*state_fab(i, j, k - 2, Idx::Pi2))/dx[2];

        amrex::Real dDDPi2_LL_00 = ((4.0/3.0)*state_fab(i + 1, j, k, Idx::Pi2) - 1.0/12.0*state_fab(i + 2, j, k, Idx::Pi2) + (4.0/3.0)*state_fab(i - 1, j, k, Idx::Pi2) - 1.0/12.0*state_fab(i - 2, j, k, Idx::Pi2) - 5.0/2.0*state_fab(i, j, k, Idx::Pi2))/std::pow(dx[0], 2);
        amrex::Real dDDPi2_LL_01 = ((4.0/9.0)*state_fab(i + 1, j + 1, k, Idx::Pi2) - 1.0/18.0*state_fab(i + 1, j + 2, k, Idx::Pi2) - 4.0/9.0*state_fab(i + 1, j - 1, k, Idx::Pi2) + (1.0/18.0)*state_fab(i + 1, j - 2, k, Idx::Pi2) - 1.0/18.0*state_fab(i + 2, j + 1, k, Idx::Pi2) + (1.0/144.0)*state_fab(i + 2, j + 2, k, Idx::Pi2) + (1.0/18.0)*state_fab(i + 2, j - 1, k, Idx::Pi2) - 1.0/144.0*state_fab(i + 2, j - 2, k, Idx::Pi2) - 4.0/9.0*state_fab(i - 1, j + 1, k, Idx::Pi2) + (1.0/18.0)*state_fab(i - 1, j + 2, k, Idx::Pi2) + (4.0/9.0)*state_fab(i - 1, j - 1, k, Idx::Pi2) - 1.0/18.0*state_fab(i - 1, j - 2, k, Idx::Pi2) + (1.0/18.0)*state_fab(i - 2, j + 1, k, Idx::Pi2) - 1.0/144.0*state_fab(i - 2, j + 2, k, Idx::Pi2) - 1.0/18.0*state_fab(i - 2, j - 1, k, Idx::Pi2) + (1.0/144.0)*state_fab(i - 2, j - 2, k, Idx::Pi2))/(dx[0]*dx[1]);
        amrex::Real dDDPi2_LL_02 = ((4.0/9.0)*state_fab(i + 1, j, k + 1, Idx::Pi2) - 1.0/18.0*state_fab(i + 1, j, k + 2, Idx::Pi2) - 4.0/9.0*state_fab(i + 1, j, k - 1, Idx::Pi2) + (1.0/18.0)*state_fab(i + 1, j, k - 2, Idx::Pi2) - 1.0/18.0*state_fab(i + 2, j, k + 1, Idx::Pi2) + (1.0/144.0)*state_fab(i + 2, j, k + 2, Idx::Pi2) + (1.0/18.0)*state_fab(i + 2, j, k - 1, Idx::Pi2) - 1.0/144.0*state_fab(i + 2, j, k - 2, Idx::Pi2) - 4.0/9.0*state_fab(i - 1, j, k + 1, Idx::Pi2) + (1.0/18.0)*state_fab(i - 1, j, k + 2, Idx::Pi2) + (4.0/9.0)*state_fab(i - 1, j, k - 1, Idx::Pi2) - 1.0/18.0*state_fab(i - 1, j, k - 2, Idx::Pi2) + (1.0/18.0)*state_fab(i - 2, j, k + 1, Idx::Pi2) - 1.0/144.0*state_fab(i - 2, j, k + 2, Idx::Pi2) - 1.0/18.0*state_fab(i - 2, j, k - 1, Idx::Pi2) + (1.0/144.0)*state_fab(i - 2, j, k - 2, Idx::Pi2))/(dx[0]*dx[2]);
        amrex::Real dDDPi2_LL_11 = ((4.0/3.0)*state_fab(i, j + 1, k, Idx::Pi2) - 1.0/12.0*state_fab(i, j + 2, k, Idx::Pi2) + (4.0/3.0)*state_fab(i, j - 1, k, Idx::Pi2) - 1.0/12.0*state_fab(i, j - 2, k, Idx::Pi2) - 5.0/2.0*state_fab(i, j, k, Idx::Pi2))/std::pow(dx[1], 2);
        amrex::Real dDDPi2_LL_12 = ((4.0/9.0)*state_fab(i, j + 1, k + 1, Idx::Pi2) - 1.0/18.0*state_fab(i, j + 1, k + 2, Idx::Pi2) - 4.0/9.0*state_fab(i, j + 1, k - 1, Idx::Pi2) + (1.0/18.0)*state_fab(i, j + 1, k - 2, Idx::Pi2) - 1.0/18.0*state_fab(i, j + 2, k + 1, Idx::Pi2) + (1.0/144.0)*state_fab(i, j + 2, k + 2, Idx::Pi2) + (1.0/18.0)*state_fab(i, j + 2, k - 1, Idx::Pi2) - 1.0/144.0*state_fab(i, j + 2, k - 2, Idx::Pi2) - 4.0/9.0*state_fab(i, j - 1, k + 1, Idx::Pi2) + (1.0/18.0)*state_fab(i, j - 1, k + 2, Idx::Pi2) + (4.0/9.0)*state_fab(i, j - 1, k - 1, Idx::Pi2) - 1.0/18.0*state_fab(i, j - 1, k - 2, Idx::Pi2) + (1.0/18.0)*state_fab(i, j - 2, k + 1, Idx::Pi2) - 1.0/144.0*state_fab(i, j - 2, k + 2, Idx::Pi2) - 1.0/18.0*state_fab(i, j - 2, k - 1, Idx::Pi2) + (1.0/144.0)*state_fab(i, j - 2, k - 2, Idx::Pi2))/(dx[1]*dx[2]);
        amrex::Real dDDPi2_LL_22 = ((4.0/3.0)*state_fab(i, j, k + 1, Idx::Pi2) - 1.0/12.0*state_fab(i, j, k + 2, Idx::Pi2) + (4.0/3.0)*state_fab(i, j, k - 1, Idx::Pi2) - 1.0/12.0*state_fab(i, j, k - 2, Idx::Pi2) - 5.0/2.0*state_fab(i, j, k, Idx::Pi2))/std::pow(dx[2], 2);

        amrex::Real dKODPi2 = ((15.0/64.0)*state_fab(i, j, k + 1, Idx::Pi2) - 3.0/32.0*state_fab(i, j, k + 2, Idx::Pi2) + (1.0/64.0)*state_fab(i, j, k + 3, Idx::Pi2) + (15.0/64.0)*state_fab(i, j, k - 1, Idx::Pi2) - 3.0/32.0*state_fab(i, j, k - 2, Idx::Pi2) + (1.0/64.0)*state_fab(i, j, k - 3, Idx::Pi2) - 5.0/16.0*state_fab(i, j, k, Idx::Pi2))/dx[2] + ((15.0/64.0)*state_fab(i, j + 1, k, Idx::Pi2) - 3.0/32.0*state_fab(i, j + 2, k, Idx::Pi2) + (1.0/64.0)*state_fab(i, j + 3, k, Idx::Pi2) + (15.0/64.0)*state_fab(i, j - 1, k, Idx::Pi2) - 3.0/32.0*state_fab(i, j - 2, k, Idx::Pi2) + (1.0/64.0)*state_fab(i, j - 3, k, Idx::Pi2) - 5.0/16.0*state_fab(i, j, k, Idx::Pi2))/dx[1] + ((15.0/64.0)*state_fab(i + 1, j, k, Idx::Pi2) - 3.0/32.0*state_fab(i + 2, j, k, Idx::Pi2) + (1.0/64.0)*state_fab(i + 3, j, k, Idx::Pi2) + (15.0/64.0)*state_fab(i - 1, j, k, Idx::Pi2) - 3.0/32.0*state_fab(i - 2, j, k, Idx::Pi2) + (1.0/64.0)*state_fab(i - 3, j, k, Idx::Pi2) - 5.0/16.0*state_fab(i, j, k, Idx::Pi2))/dx[0];

        amrex::Real dtphi1 = KOSigma*dKODPhi1 + Pi1;

        diag(i, j, k, Diag::Phi1) = dtphi1;

        amrex::Real dtphi2 = KOSigma*dKODPhi2 + Pi2;

        diag(i, j, k, Diag::Phi2) = dtphi2;

        amrex::Real V = (1.0/4.0)*lambda*std::pow((1.0/2.0)*std::pow(Phi1, 2) + (1.0/2.0)*std::pow(Phi2, 2) - std::pow(v, 2), 2);

        amrex::Real dVdphi1 = (1.0/2.0)*Phi1*lambda*((1.0/2.0)*std::pow(Phi1, 2) + (1.0/2.0)*std::pow(Phi2, 2) - std::pow(v, 2));

        amrex::Real dVdphi2 = (1.0/2.0)*Phi2*lambda*((1.0/2.0)*std::pow(Phi1, 2) + (1.0/2.0)*std::pow(Phi2, 2) - std::pow(v, 2));

        amrex::Real g4_LL_00 = -1;
        amrex::Real g4_LL_01 = 0;
        amrex::Real g4_LL_02 = 0;
        amrex::Real g4_LL_03 = 0;
        amrex::Real g4_LL_11 = 1;
        amrex::Real g4_LL_12 = 0;
        amrex::Real g4_LL_13 = 0;
        amrex::Real g4_LL_22 = 1;
        amrex::Real g4_LL_23 = 0;
        amrex::Real g4_LL_33 = 1;

        amrex::Real a_L_0 = -A;
        amrex::Real a_L_1 = A_L_0;
        amrex::Real a_L_2 = A_L_1;
        amrex::Real a_L_3 = A_L_2;

        amrex::Real a_U_0 = a_L_0*g4_LL_00 + a_L_1*g4_LL_01 + a_L_2*g4_LL_02 + a_L_3*g4_LL_03;
        amrex::Real a_U_1 = a_L_0*g4_LL_01 + a_L_1*g4_LL_11 + a_L_2*g4_LL_12 + a_L_3*g4_LL_13;
        amrex::Real a_U_2 = a_L_0*g4_LL_02 + a_L_1*g4_LL_12 + a_L_2*g4_LL_22 + a_L_3*g4_LL_23;
        amrex::Real a_U_3 = a_L_0*g4_LL_03 + a_L_1*g4_LL_13 + a_L_2*g4_LL_23 + a_L_3*g4_LL_33;

        amrex::Real J_L_0 = Phi1*dtphi2 - Phi2*dtphi1 - a_L_0*echarge*(std::pow(Phi1, 2) + std::pow(Phi2, 2));
        amrex::Real J_L_1 = Phi1*dDPhi2_L_0 - Phi2*dDPhi1_L_0 - a_L_1*echarge*(std::pow(Phi1, 2) + std::pow(Phi2, 2));
        amrex::Real J_L_2 = Phi1*dDPhi2_L_1 - Phi2*dDPhi1_L_1 - a_L_2*echarge*(std::pow(Phi1, 2) + std::pow(Phi2, 2));
        amrex::Real J_L_3 = Phi1*dDPhi2_L_2 - Phi2*dDPhi1_L_2 - a_L_3*echarge*(std::pow(Phi1, 2) + std::pow(Phi2, 2));

        amrex::Real scrJ_L_0 = J_L_1;
        amrex::Real scrJ_L_1 = J_L_2;
        amrex::Real scrJ_L_2 = J_L_3;

        amrex::Real n_L_0 = -1;
        amrex::Real n_L_1 = 0;
        amrex::Real n_L_2 = 0;
        amrex::Real n_L_3 = 0;

        amrex::Real n_U_0 = 1;
        amrex::Real n_U_1 = 0;
        amrex::Real n_U_2 = 0;
        amrex::Real n_U_3 = 0;

        amrex::Real scrJ = -J_L_0;

        amrex::Real scrJ_U_0 = scrJ_L_0;
        amrex::Real scrJ_U_1 = scrJ_L_1;
        amrex::Real scrJ_U_2 = scrJ_L_2;

        diag(i, j, k, Diag::E_U_0) = - dDDA_LLL_011 - dDDA_LLL_022 + dDDA_LLL_101 + dDDA_LLL_202 + dDZ_L_0 + dKODE_U_0 - echarge*scrJ_U_0;
        diag(i, j, k, Diag::E_U_1) =  dDDA_LLL_001 - dDDA_LLL_100 - dDDA_LLL_122 + dDDA_LLL_212 + dDZ_L_1 + dKODE_U_1 - echarge*scrJ_U_1;
        diag(i, j, k, Diag::E_U_2) =  dDDA_LLL_002 + dDDA_LLL_112 - dDDA_LLL_200 - dDDA_LLL_211 + dDZ_L_2 + dKODE_U_2 - echarge*scrJ_U_2;

        diag(i, j, k, Diag::A) = -Z - dDA_LL_00 - dDA_LL_11 - dDA_LL_22 + dKODA;

        diag(i, j, k, Diag::A_L_0) = -E_U_0 - dDA_L_0 + dKODA_L_0;
        diag(i, j, k, Diag::A_L_1) = -E_U_1 - dDA_L_1 + dKODA_L_1;
        diag(i, j, k, Diag::A_L_2) = -E_U_2 - dDA_L_2 + dKODA_L_2;

        diag(i, j, k, Idx::Z) = -Z*kappaEM + dDE_UL_00 + dDE_UL_11 + dDE_UL_22 + dKODZ - echarge*scrJ;

        amrex::Real Dphi1_L_0 = dtphi1;
        amrex::Real Dphi1_L_1 = dDPhi1_L_0;
        amrex::Real Dphi1_L_2 = dDPhi1_L_1;
        amrex::Real Dphi1_L_3 = dDPhi1_L_2;

        amrex::Real Dphi2_L_0 = dtphi2;
        amrex::Real Dphi2_L_1 = dDPhi2_L_0;
        amrex::Real Dphi2_L_2 = dDPhi2_L_1;
        amrex::Real Dphi2_L_3 = dDPhi2_L_2;

        diag(i, j, k, Diag::Pi1) = 2*Dphi2_L_0*a_U_0*echarge + 2*Dphi2_L_1*a_U_1*echarge + 2*Dphi2_L_2*a_U_2*echarge + 2*Dphi2_L_3*a_U_3*echarge - Phi1*a_L_0*a_U_0*std::pow(echarge, 2) - Phi1*a_L_1*a_U_1*std::pow(echarge, 2) - Phi1*a_L_2*a_U_2*std::pow(echarge, 2) - Phi1*a_L_3*a_U_3*std::pow(echarge, 2) + dDDPhi1_LL_00 + dDDPhi1_LL_11 + dDDPhi1_LL_22 + dKODPi1 - dVdphi1;

        diag(i, j, k, Diag::Pi2) = -2*Dphi1_L_0*a_U_0*echarge - 2*Dphi1_L_1*a_U_1*echarge - 2*Dphi1_L_2*a_U_2*echarge - 2*Dphi1_L_3*a_U_3*echarge - Phi2*a_L_0*a_U_0*std::pow(echarge, 2) - Phi2*a_L_1*a_U_1*std::pow(echarge, 2) - Phi2*a_L_2*a_U_2*std::pow(echarge, 2) - Phi2*a_L_3*a_U_3*std::pow(echarge, 2) + dDDPhi2_LL_00 + dDDPhi2_LL_11 + dDDPhi2_LL_22 + dKODPi2 - dVdphi2;
        
}
#endif