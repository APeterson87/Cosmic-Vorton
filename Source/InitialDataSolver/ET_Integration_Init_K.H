#ifndef ET_INTEGRATION_INIT_K_H
#define ET_INTEGRATION_INIT_K_H

#include <AMReX_REAL.H> 
#include <AMReX_Array4.H> 
#include <ET_Integration_Setup_K.H> 

AMREX_GPU_DEVICE 
inline 
void 
state_init(int i, int j, int k, 
        amrex::Array4<amrex::Real> const& state_fab, 
        amrex::Real time, const amrex::GeometryData& geom) noexcept 
{
        const auto domain_xlo = geom.ProbLo(); 
        
        amrex::Real x_U_0 = (i + 0.5)*geom.CellSize(0) + domain_xlo[0]; 
        amrex::Real x_U_1 = (j + 0.5)*geom.CellSize(1) + domain_xlo[1]; 
        amrex::Real x_U_2 = (k + 0.5)*geom.CellSize(2) + domain_xlo[2]; 
        
        amrex::Real R = 100;
        
        amrex::Real x = x_U_0;
        amrex::Real y = x_U_1;
        amrex::Real z = x_U_2;
        
        
        amrex::Real rdomain = std::sqrt(x*x + y*y + z*z);
        
        amrex::Real rsq = std::pow((std::sqrt(x*x + y*y)-R),2) + z*z;
        amrex::Real r = std::sqrt(rsq);
        
        amrex::Real x2 = r/500;
        
        amrex::Real V, A, B, u;
        
        amrex::Real lambda = 2.0;
        amrex::Real eta = 0.05;
        amrex::Real e = std::sqrt(lambda/2.0);
        
        //amrex::Real x2 = std::sqrt(x_U_0*x_U_0 + x_U_1*x_U_1 + x_U_2*x_U_2)/1000;
        
        if(r < 500.0)
        {
        
        amrex::Real QF = 0.4027642425104318*x2 - 0.18389804471411586*std::cos(2*std::acos(2*x2 - 1)) + 0.15785299937437691*std::cos(3*std::acos(2*x2 - 1)) - 0.12705591130856209*std::cos(4*std::acos(2*x2 - 1)) + 0.095476923821582724*std::cos(5*std::acos(2*x2 - 1)) - 0.066454401105316849*std::cos(6*std::acos(2*x2 - 1)) + 0.042203947720811624*std::cos(7*std::acos(2*x2 - 1)) - 0.023695995294027064*std::cos(8*std::acos(2*x2 - 1)) + 0.010837852846319043*std::cos(9*std::acos(2*x2 - 1)) - 0.002823817816695386*std::cos(10*std::acos(2*x2 - 1)) - 0.0014872210869433123*std::cos(11*std::acos(2*x2 - 1)) + 0.0032650768876229929*std::cos(12*std::acos(2*x2 - 1)) - 0.00351448500401297*std::cos(13*std::acos(2*x2 - 1)) + 0.0029904875622377026*std::cos(14*std::acos(2*x2 - 1)) - 0.0021942044300177956*std::cos(15*std::acos(2*x2 - 1)) + 0.0014142663155602229*std::cos(16*std::acos(2*x2 - 1)) - 0.00078499575203161941*std::cos(17*std::acos(2*x2 - 1)) + 0.00034255646011249578*std::cos(18*std::acos(2*x2 - 1)) - 6.9827385533750494e-5*std::cos(19*std::acos(2*x2 - 1)) - 7.2439677694600621e-5*std::cos(20*std::acos(2*x2 - 1)) + 0.00012676980842400189*std::cos(21*std::acos(2*x2 - 1)) - 0.00012943688543993505*std::cos(22*std::acos(2*x2 - 1)) + 0.00010710284965785057*std::cos(23*std::acos(2*x2 - 1)) - 7.6990340906982202e-5*std::cos(24*std::acos(2*x2 - 1)) + 4.869405016596183e-5*std::cos(25*std::acos(2*x2 - 1)) - 2.6435364062852781e-5*std::cos(26*std::acos(2*x2 - 1)) + 1.1114226556524845e-5*std::cos(27*std::acos(2*x2 - 1)) - 1.8896726518488616e-6*std::cos(28*std::acos(2*x2 - 1)) - 2.7520118106080099e-6*std::cos(29*std::acos(2*x2 - 1)) + 4.3673727191367168e-6*std::cos(30*std::acos(2*x2 - 1)) - 4.248918325301318e-6*std::cos(31*std::acos(2*x2 - 1)) + 3.3276444457788767e-6*std::cos(32*std::acos(2*x2 - 1)) - 2.1927722615843609e-6*std::cos(33*std::acos(2*x2 - 1)) + 1.1635335836236715e-6*std::cos(34*std::acos(2*x2 - 1)) - 3.725628428142419e-7*std::cos(35*std::acos(2*x2 - 1)) - 1.604239206302871e-7*std::cos(36*std::acos(2*x2 - 1)) + 4.7301246562832244e-7*std::cos(37*std::acos(2*x2 - 1)) - 6.2320288779678379e-7*std::cos(38*std::acos(2*x2 - 1)) + 6.6814971249294641e-7*std::cos(39*std::acos(2*x2 - 1)) - 6.5420500528282077e-7*std::cos(40*std::acos(2*x2 - 1)) + 6.1414874707489686e-7*std::cos(41*std::acos(2*x2 - 1)) - 5.6834075525154237e-7*std::cos(42*std::acos(2*x2 - 1)) + 5.2752763162952632e-7*std::cos(43*std::acos(2*x2 - 1)) - 4.9592603294963677e-7*std::cos(44*std::acos(2*x2 - 1)) + 4.7387666495153635e-7*std::cos(45*std::acos(2*x2 - 1)) - 4.5981173599739245e-7*std::cos(46*std::acos(2*x2 - 1)) + 4.5153822701704538e-7*std::cos(47*std::acos(2*x2 - 1)) - 4.4696240472652526e-7*std::cos(48*std::acos(2*x2 - 1)) + 4.4441700539597784e-7*std::cos(49*std::acos(2*x2 - 1)) - 4.4273988427691313e-7*std::cos(50*std::acos(2*x2 - 1)) + 4.4121997504892319e-7*std::cos(51*std::acos(2*x2 - 1)) - 4.3948993997192098e-7*std::cos(52*std::acos(2*x2 - 1)) + 4.3741280377103398e-7*std::cos(53*std::acos(2*x2 - 1)) - 4.3498620652844544e-7*std::cos(54*std::acos(2*x2 - 1)) + 4.3227246420037002e-7*std::cos(55*std::acos(2*x2 - 1)) - 4.2935355873234549e-7*std::cos(56*std::acos(2*x2 - 1)) + 4.2630604836328689e-7*std::cos(57*std::acos(2*x2 - 1)) - 4.2319007094275551e-7*std::cos(58*std::acos(2*x2 - 1)) + 4.2004712984961001e-7*std::cos(59*std::acos(2*x2 - 1)) - 4.1690234687564998e-7*std::cos(60*std::acos(2*x2 - 1)) + 4.1376846885397833e-7*std::cos(61*std::acos(2*x2 - 1)) - 4.1065005622863138e-7*std::cos(62*std::acos(2*x2 - 1)) + 4.0754692697854422e-7*std::cos(63*std::acos(2*x2 - 1)) - 4.0445664505409096e-7*std::cos(64*std::acos(2*x2 - 1)) + 4.013761398611454e-7*std::cos(65*std::acos(2*x2 - 1)) - 3.9830260255106775e-7*std::cos(66*std::acos(2*x2 - 1)) + 3.9523382724081235e-7*std::cos(67*std::acos(2*x2 - 1)) - 3.9216827570076607e-7*std::cos(68*std::acos(2*x2 - 1)) + 3.8910502678755898e-7*std::cos(69*std::acos(2*x2 - 1)) - 3.8604361168523282e-7*std::cos(70*std::acos(2*x2 - 1)) + 3.8298384341141356e-7*std::cos(71*std::acos(2*x2 - 1)) - 3.7992569851090507e-7*std::cos(72*std::acos(2*x2 - 1)) + 3.7686924220063645e-7*std::cos(73*std::acos(2*x2 - 1)) - 3.7381456945324854e-7*std::cos(74*std::acos(2*x2 - 1)) + 3.7076175154505953e-7*std::cos(75*std::acos(2*x2 - 1)) - 3.6771084349282446e-7*std::cos(76*std::acos(2*x2 - 1)) + 3.6466188321933324e-7*std::cos(77*std::acos(2*x2 - 1)) - 3.6161488620699289e-7*std::cos(78*std::acos(2*x2 - 1)) + 3.585698741866844e-7*std::cos(79*std::acos(2*x2 - 1)) - 3.5552686371113917e-7*std::cos(80*std::acos(2*x2 - 1)) + 3.5248585450280145e-7*std::cos(81*std::acos(2*x2 - 1)) - 3.4944686611027009e-7*std::cos(82*std::acos(2*x2 - 1)) + 3.4640992565074247e-7*std::cos(83*std::acos(2*x2 - 1)) - 3.4337501315408192e-7*std::cos(84*std::acos(2*x2 - 1)) + 3.403420777998295e-7*std::cos(85*std::acos(2*x2 - 1)) - 3.3731102507157662e-7*std::cos(86*std::acos(2*x2 - 1)) + 3.3428164418480844e-7*std::cos(87*std::acos(2*x2 - 1)) - 3.3125361649163909e-7*std::cos(88*std::acos(2*x2 - 1)) + 3.2822654731819167e-7*std::cos(89*std::acos(2*x2 - 1)) - 3.2519996431140674e-7*std::cos(90*std::acos(2*x2 - 1)) + 3.2217339213276575e-7*std::cos(91*std::acos(2*x2 - 1)) - 3.1914651246744974e-7*std::cos(92*std::acos(2*x2 - 1)) + 3.1611928258921951e-7*std::cos(93*std::acos(2*x2 - 1)) - 3.1309200383689006e-7*std::cos(94*std::acos(2*x2 - 1)) + 3.1006537510799848e-7*std::cos(95*std::acos(2*x2 - 1)) - 3.0704084429296341e-7*std::cos(96*std::acos(2*x2 - 1)) + 3.0401916045232069e-7*std::cos(97*std::acos(2*x2 - 1)) - 3.0104901199527745e-7*std::cos(98*std::acos(2*x2 - 1)) + 1.4904154979188816e-7*std::cos(99*std::acos(2*x2 - 1)) + 0.6948447478116353;


        amrex::Real QA = 0.55276503846435909*x2 - 0.23936818884352123*std::cos(2*std::acos(2*x2 - 1)) + 0.18662182001817759*std::cos(3*std::acos(2*x2 - 1)) - 0.12846424571256707*std::cos(4*std::acos(2*x2 - 1)) + 0.074552212778171589*std::cos(5*std::acos(2*x2 - 1)) - 0.031566725668219449*std::cos(6*std::acos(2*x2 - 1)) + 0.0022962348727725099*std::cos(7*std::acos(2*x2 - 1)) + 0.013917876902396703*std::cos(8*std::acos(2*x2 - 1)) - 0.019914492249186726*std::cos(9*std::acos(2*x2 - 1)) + 0.019295304251206263*std::cos(10*std::acos(2*x2 - 1)) - 0.015343330578890839*std::cos(11*std::acos(2*x2 - 1)) + 0.010461431282100952*std::cos(12*std::acos(2*x2 - 1)) - 0.006068246695419487*std::cos(13*std::acos(2*x2 - 1)) + 0.0027734527376973035*std::cos(14*std::acos(2*x2 - 1)) - 0.00065389755578986776*std::cos(15*std::acos(2*x2 - 1)) - 0.00048914074586221302*std::cos(16*std::acos(2*x2 - 1)) + 0.00094483857333296263*std::cos(17*std::acos(2*x2 - 1)) - 0.00098576512449042274*std::cos(18*std::acos(2*x2 - 1)) + 0.00082158787425834316*std::cos(19*std::acos(2*x2 - 1)) - 0.00059082213384450792*std::cos(20*std::acos(2*x2 - 1)) + 0.00037157081218074615*std::cos(21*std::acos(2*x2 - 1)) - 0.00019856800733484246*std::cos(22*std::acos(2*x2 - 1)) + 7.9578274839640917e-5*std::cos(23*std::acos(2*x2 - 1)) - 8.2216888077826095e-6*std::cos(24*std::acos(2*x2 - 1)) - 2.7349960891508152e-5*std::cos(25*std::acos(2*x2 - 1)) + 3.936060005058431e-5*std::cos(26*std::acos(2*x2 - 1)) - 3.7947861057990515e-5*std::cos(27*std::acos(2*x2 - 1)) + 3.039151172942213e-5*std::cos(28*std::acos(2*x2 - 1)) - 2.1278087551670349e-5*std::cos(29*std::acos(2*x2 - 1)) + 1.3075166567800764e-5*std::cos(30*std::acos(2*x2 - 1)) - 6.7926111380362669e-6*std::cos(31*std::acos(2*x2 - 1)) + 2.563100425916412e-6*std::cos(32*std::acos(2*x2 - 1)) - 7.7886171151453354e-8*std::cos(33*std::acos(2*x2 - 1)) - 1.1258144354906602e-6*std::cos(34*std::acos(2*x2 - 1)) + 1.5002500691387727e-6*std::cos(35*std::acos(2*x2 - 1)) - 1.4108203638153738e-6*std::cos(36*std::acos(2*x2 - 1)) + 1.1155264080867089e-6*std::cos(37*std::acos(2*x2 - 1)) - 7.74629689165654e-7*std::cos(38*std::acos(2*x2 - 1)) + 4.7290932321357448e-7*std::cos(39*std::acos(2*x2 - 1)) - 2.438783735358302e-7*std::cos(40*std::acos(2*x2 - 1)) + 9.055613165408205e-8*std::cos(41*std::acos(2*x2 - 1)) - 8.5459673539178826e-10*std::cos(42*std::acos(2*x2 - 1)) - 4.2369955348051103e-8*std::cos(43*std::acos(2*x2 - 1)) + 5.561387308485044e-8*std::cos(44*std::acos(2*x2 - 1)) - 5.2119078651838291e-8*std::cos(45*std::acos(2*x2 - 1)) + 4.1209347299148158e-8*std::cos(46*std::acos(2*x2 - 1)) - 2.8672564131998479e-8*std::cos(47*std::acos(2*x2 - 1)) + 1.7573916044621996e-8*std::cos(48*std::acos(2*x2 - 1)) - 9.1295373882277486e-9*std::cos(49*std::acos(2*x2 - 1)) + 3.4534277295467097e-9*std::cos(50*std::acos(2*x2 - 1)) - 1.1082883222268691e-10*std::cos(51*std::acos(2*x2 - 1)) - 1.5194168319354606e-9*std::cos(52*std::acos(2*x2 - 1)) + 2.0381040848060916e-9*std::cos(53*std::acos(2*x2 - 1)) - 1.9301244196662237e-9*std::cos(54*std::acos(2*x2 - 1)) + 1.5391657618574195e-9*std::cos(55*std::acos(2*x2 - 1)) - 1.0804797560132195e-9*std::cos(56*std::acos(2*x2 - 1)) + 6.6964058777208013e-10*std::cos(57*std::acos(2*x2 - 1)) - 3.5392306620141145e-10*std::cos(58*std::acos(2*x2 - 1)) + 1.3943033012886463e-10*std::cos(59*std::acos(2*x2 - 1)) - 1.1363103166739386e-11*std::cos(60*std::acos(2*x2 - 1)) - 5.2556100096912139e-11*std::cos(61*std::acos(2*x2 - 1)) + 7.4294580904021856e-11*std::cos(62*std::acos(2*x2 - 1)) - 7.1847101185129603e-11*std::cos(63*std::acos(2*x2 - 1)) + 5.8144697390183353e-11*std::cos(64*std::acos(2*x2 - 1)) - 4.1388821189758396e-11*std::cos(65*std::acos(2*x2 - 1)) + 2.606783192082851e-11*std::cos(66*std::acos(2*x2 - 1)) - 1.4112860186044074e-11*std::cos(67*std::acos(2*x2 - 1)) + 5.8657158991115566e-12*std::cos(68*std::acos(2*x2 - 1)) - 8.3035488207539032e-13*std::cos(69*std::acos(2*x2 - 1)) - 1.7962905468627e-12*std::cos(70*std::acos(2*x2 - 1)) + 2.8366042154059912e-12*std::cos(71*std::acos(2*x2 - 1)) - 2.9683512592360017e-12*std::cos(72*std::acos(2*x2 - 1)) + 2.6695798349685163e-12*std::cos(73*std::acos(2*x2 - 1)) - 2.2462032234216167e-12*std::cos(74*std::acos(2*x2 - 1)) + 1.8362152076623062e-12*std::cos(75*std::acos(2*x2 - 1)) - 1.455517997794864e-12*std::cos(76*std::acos(2*x2 - 1)) + 1.0487721802121541e-12*std::cos(77*std::acos(2*x2 - 1)) - 5.2201298839094079e-13*std::cos(78*std::acos(2*x2 - 1)) - 2.1256434112881806e-13*std::cos(79*std::acos(2*x2 - 1)) + 1.2058444520679501e-12*std::cos(80*std::acos(2*x2 - 1)) - 2.4343999038833886e-12*std::cos(81*std::acos(2*x2 - 1)) + 3.7616246922889118e-12*std::cos(82*std::acos(2*x2 - 1)) - 4.9228000148504591e-12*std::cos(83*std::acos(2*x2 - 1)) + 5.5308726348846093e-12*std::cos(84*std::acos(2*x2 - 1)) - 5.1208603329966351e-12*std::cos(85*std::acos(2*x2 - 1)) + 3.2572208819026116e-12*std::cos(86*std::acos(2*x2 - 1)) + 3.3430723467287038e-13*std::cos(87*std::acos(2*x2 - 1)) - 5.5996058484497624e-12*std::cos(88*std::acos(2*x2 - 1)) + 1.1977717429001444e-11*std::cos(89*std::acos(2*x2 - 1)) - 1.8343038893364749e-11*std::cos(90*std::acos(2*x2 - 1)) + 2.310922460335707e-11*std::cos(91*std::acos(2*x2 - 1)) - 2.4527354106074206e-11*std::cos(92*std::acos(2*x2 - 1)) + 2.1207103781395453e-11*std::cos(93*std::acos(2*x2 - 1)) - 1.2703683591186454e-11*std::cos(94*std::acos(2*x2 - 1)) - 5.2582938003808977e-14*std::cos(95*std::acos(2*x2 - 1)) + 1.4714741577992463e-11*std::cos(96*std::acos(2*x2 - 1)) - 2.8015218617172266e-11*std::cos(97*std::acos(2*x2 - 1)) + 3.6693972513268669e-11*std::cos(98*std::acos(2*x2 - 1)) - 1.9650103592894208e-11*std::cos(99*std::acos(2*x2 - 1)) + 0.57875914602311962;


        amrex::Real QDF = -0.02224224015009937*x2 + 0.009931587863894845*std::cos(2*std::acos(2*x2 - 1)) - 0.0081787454748746286*std::cos(3*std::acos(2*x2 - 1)) + 0.0061431083019507001*std::cos(4*std::acos(2*x2 - 1)) - 0.0041129481814060117*std::cos(5*std::acos(2*x2 - 1)) + 0.0023240237109180802*std::cos(6*std::acos(2*x2 - 1)) - 0.00092313054871554574*std::cos(7*std::acos(2*x2 - 1)) - 3.940208829890056e-5*std::cos(8*std::acos(2*x2 - 1)) + 0.00059341618319564825*std::cos(9*std::acos(2*x2 - 1)) - 0.00081972905388779478*std::cos(10*std::acos(2*x2 - 1)) + 0.0008193220603430379*std::cos(11*std::acos(2*x2 - 1)) - 0.0006888533364853988*std::cos(12*std::acos(2*x2 - 1)) + 0.00050587405223517714*std::cos(13*std::acos(2*x2 - 1)) - 0.00032334616505359283*std::cos(14*std::acos(2*x2 - 1)) + 0.000170938775393975*std::cos(15*std::acos(2*x2 - 1)) - 6.0041106841354249e-5*std::cos(16*std::acos(2*x2 - 1)) - 1.0087675050652799e-5*std::cos(17*std::acos(2*x2 - 1)) + 4.6718528954134727e-5*std::cos(18*std::acos(2*x2 - 1)) - 5.9415903963299735e-5*std::cos(19*std::acos(2*x2 - 1)) + 5.7332312782878129e-5*std::cos(20*std::acos(2*x2 - 1)) - 4.782553235140666e-5*std::cos(21*std::acos(2*x2 - 1)) + 3.603494237292276e-5*std::cos(22*std::acos(2*x2 - 1)) - 2.5044594952052738e-5*std::cos(23*std::acos(2*x2 - 1)) + 1.6327978621876682e-5*std::cos(24*std::acos(2*x2 - 1)) - 1.02624199335687e-5*std::cos(25*std::acos(2*x2 - 1)) + 6.5891491110749058e-6*std::cos(26*std::acos(2*x2 - 1)) - 4.7638532114462585e-6*std::cos(27*std::acos(2*x2 - 1)) + 4.1884713735315047e-6*std::cos(28*std::acos(2*x2 - 1)) - 4.340565690796041e-6*std::cos(29*std::acos(2*x2 - 1)) + 4.8269393904402135e-6*std::cos(30*std::acos(2*x2 - 1)) - 5.3887372397400034e-6*std::cos(31*std::acos(2*x2 - 1)) + 5.8806732426207697e-6*std::cos(32*std::acos(2*x2 - 1)) - 6.2406159217270521e-6*std::cos(33*std::acos(2*x2 - 1)) + 6.4595662775482568e-6*std::cos(34*std::acos(2*x2 - 1)) - 6.5570976894141092e-6*std::cos(35*std::acos(2*x2 - 1)) + 6.5638840820956339e-6*std::cos(36*std::acos(2*x2 - 1)) - 6.5108955078263701e-6*std::cos(37*std::acos(2*x2 - 1)) + 6.4238721122933538e-6*std::cos(38*std::acos(2*x2 - 1)) - 6.3214414511244104e-6*std::cos(39*std::acos(2*x2 - 1)) + 6.215408985028349e-6*std::cos(40*std::acos(2*x2 - 1)) - 6.1120954306281453e-6*std::cos(41*std::acos(2*x2 - 1)) + 6.0139677931171157e-6*std::cos(42*std::acos(2*x2 - 1)) - 5.9211325549814851e-6*std::cos(43*std::acos(2*x2 - 1)) + 5.832497924920802e-6*std::cos(44*std::acos(2*x2 - 1)) - 5.7465662423296003e-6*std::cos(45*std::acos(2*x2 - 1)) + 5.6619019843601579e-6*std::cos(46*std::acos(2*x2 - 1)) - 5.5773551850513155e-6*std::cos(47*std::acos(2*x2 - 1)) + 5.4921232714539179e-6*std::cos(48*std::acos(2*x2 - 1)) - 5.4057212783092171e-6*std::cos(49*std::acos(2*x2 - 1)) + 5.3179114568801168e-6*std::cos(50*std::acos(2*x2 - 1)) - 5.2286249704703573e-6*std::cos(51*std::acos(2*x2 - 1)) + 5.1378933469981307e-6*std::cos(52*std::acos(2*x2 - 1)) - 5.0457967897697972e-6*std::cos(53*std::acos(2*x2 - 1)) + 4.9524299473286366e-6*std::cos(54*std::acos(2*x2 - 1)) - 4.8578823727529917e-6*std::cos(55*std::acos(2*x2 - 1)) + 4.7622296826376326e-6*std::cos(56*std::acos(2*x2 - 1)) - 4.6655315937233181e-6*std::cos(57*std::acos(2*x2 - 1)) + 4.5678337358326399e-6*std::cos(58*std::acos(2*x2 - 1)) - 4.4691710080498024e-6*std::cos(59*std::acos(2*x2 - 1)) + 4.3695710940870072e-6*std::cos(60*std::acos(2*x2 - 1)) - 4.2690574813882695e-6*std::cos(61*std::acos(2*x2 - 1)) + 4.1676516774595898e-6*std::cos(62*std::acos(2*x2 - 1)) - 4.065374646157658e-6*std::cos(63*std::acos(2*x2 - 1)) + 3.9622476153757086e-6*std::cos(64*std::acos(2*x2 - 1)) - 3.8582924296919094e-6*std::cos(65*std::acos(2*x2 - 1)) + 3.7535316052253073e-6*std::cos(66*std::acos(2*x2 - 1)) - 3.6479882349534295e-6*std::cos(67*std::acos(2*x2 - 1)) + 3.5416858501068422e-6*std::cos(68*std::acos(2*x2 - 1)) - 3.434648266316073e-6*std::cos(69*std::acos(2*x2 - 1)) + 3.3268994457695623e-6*std::cos(70*std::acos(2*x2 - 1)) - 3.2184634113631477e-6*std::cos(71*std::acos(2*x2 - 1)) + 3.1093641876148685e-6*std::cos(72*std::acos(2*x2 - 1)) - 2.9996257714296452e-6*std::cos(73*std::acos(2*x2 - 1)) + 2.8892721100457371e-6*std::cos(74*std::acos(2*x2 - 1)) - 2.7783271036777283e-6*std::cos(75*std::acos(2*x2 - 1)) + 2.666814614150812e-6*std::cos(76*std::acos(2*x2 - 1)) - 2.5547584636560298e-6*std::cos(77*std::acos(2*x2 - 1)) + 2.4421824448139359e-6*std::cos(78*std::acos(2*x2 - 1)) - 2.3291103233868905e-6*std::cos(79*std::acos(2*x2 - 1)) + 2.2155658311145538e-6*std::cos(80*std::acos(2*x2 - 1)) - 2.1015726755589482e-6*std::cos(81*std::acos(2*x2 - 1)) + 1.9871545406314754e-6*std::cos(82*std::acos(2*x2 - 1)) - 1.8723350729403161e-6*std::cos(83*std::acos(2*x2 - 1)) + 1.7571378899310743e-6*std::cos(84*std::acos(2*x2 - 1)) - 1.6415866025181387e-6*std::cos(85*std::acos(2*x2 - 1)) + 1.5257048141556024e-6*std::cos(86*std::acos(2*x2 - 1)) - 1.4095161532194267e-6*std::cos(87*std::acos(2*x2 - 1)) + 1.2930443244712701e-6*std::cos(88*std::acos(2*x2 - 1)) - 1.1763131408657006e-6*std::cos(89*std::acos(2*x2 - 1)) + 1.0593465554687141e-6*std::cos(90*std::acos(2*x2 - 1)) - 9.4216869823196337e-7*std::cos(91*std::acos(2*x2 - 1)) + 8.2480385687826754e-7*std::cos(92*std::acos(2*x2 - 1)) - 7.0727639528511311e-7*std::cos(93*std::acos(2*x2 - 1)) + 5.8961064021818001e-7*std::cos(94*std::acos(2*x2 - 1)) - 4.7183073745994708e-7*std::cos(95*std::acos(2*x2 - 1)) + 3.5396048381303811e-7*std::cos(96*std::acos(2*x2 - 1)) - 2.3602289744589097e-7*std::cos(97*std::acos(2*x2 - 1)) + 1.1804114351108918e-7*std::cos(98*std::acos(2*x2 - 1)) - 2.0299141453172616e-17*std::cos(99*std::acos(2*x2 - 1)) + 0.016892444103078108;


        amrex::Real QDA = -0.01204896816874217*x2 + 0.0044070071830078555*std::cos(2*std::acos(2*x2 - 1)) - 0.0021945854030773993*std::cos(3*std::acos(2*x2 - 1)) - 7.1925455293637305e-5*std::cos(4*std::acos(2*x2 - 1)) + 0.0019162786814529592*std::cos(5*std::acos(2*x2 - 1)) - 0.0030540199306095736*std::cos(6*std::acos(2*x2 - 1)) + 0.0034314845439392182*std::cos(7*std::acos(2*x2 - 1)) - 0.0031826093406635727*std::cos(8*std::acos(2*x2 - 1)) + 0.0025407386406940194*std::cos(9*std::acos(2*x2 - 1)) - 0.0017487630310295027*std::cos(10*std::acos(2*x2 - 1)) + 0.00099711121334267877*std::cos(11*std::acos(2*x2 - 1)) - 0.00039854723965559161*std::cos(12*std::acos(2*x2 - 1)) - 7.1881983378742772e-6*std::cos(13*std::acos(2*x2 - 1)) + 0.00023255167886600017*std::cos(14*std::acos(2*x2 - 1)) - 0.00031781552621466542*std::cos(15*std::acos(2*x2 - 1)) + 0.0003110195424965074*std::cos(16*std::acos(2*x2 - 1)) - 0.00025520538552402112*std::cos(17*std::acos(2*x2 - 1)) + 0.0001825212395265447*std::cos(18*std::acos(2*x2 - 1)) - 0.00011325492369646979*std::cos(19*std::acos(2*x2 - 1)) + 5.7639632876098453e-5*std::cos(20*std::acos(2*x2 - 1)) - 1.8723193217873172e-5*std::cos(21*std::acos(2*x2 - 1)) - 4.7843884182942275e-6*std::cos(22*std::acos(2*x2 - 1)) + 1.6224845969190061e-5*std::cos(23*std::acos(2*x2 - 1)) - 1.9426820273713767e-5*std::cos(24*std::acos(2*x2 - 1)) + 1.7803413377403158e-5*std::cos(25*std::acos(2*x2 - 1)) - 1.3956817155357321e-5*std::cos(26*std::acos(2*x2 - 1)) + 9.6163921927671209e-6*std::cos(27*std::acos(2*x2 - 1)) - 5.7600627733124566e-6*std::cos(28*std::acos(2*x2 - 1)) + 2.8086799500161853e-6*std::cos(29*std::acos(2*x2 - 1)) - 8.2353658834566174e-7*std::cos(30*std::acos(2*x2 - 1)) - 3.2936630236276465e-7*std::cos(31*std::acos(2*x2 - 1)) + 8.6103434307814975e-7*std::cos(32*std::acos(2*x2 - 1)) - 9.8552132380393367e-7*std::cos(33*std::acos(2*x2 - 1)) + 8.815963334547741e-7*std::cos(34*std::acos(2*x2 - 1)) - 6.7929918488108738e-7*std::cos(35*std::acos(2*x2 - 1)) + 4.6152547386521384e-7*std::cos(36*std::acos(2*x2 - 1)) - 2.7298210744529742e-7*std::cos(37*std::acos(2*x2 - 1)) + 1.3132899675744276e-7*std::cos(38*std::acos(2*x2 - 1)) - 3.7494211031381686e-8*std::cos(39*std::acos(2*x2 - 1)) - 1.6219007225695132e-8*std::cos(40*std::acos(2*x2 - 1)) + 4.0547024667708383e-8*std::cos(41*std::acos(2*x2 - 1)) - 4.5921477797943412e-8*std::cos(42*std::acos(2*x2 - 1)) + 4.0834169726941467e-8*std::cos(43*std::acos(2*x2 - 1)) - 3.1346183991431726e-8*std::cos(44*std::acos(2*x2 - 1)) + 2.1258047164138729e-8*std::cos(45*std::acos(2*x2 - 1)) - 1.2583278143562387e-8*std::cos(46*std::acos(2*x2 - 1)) + 6.0929770258294174e-9*std::cos(47*std::acos(2*x2 - 1)) - 1.8023724674869028e-9*std::cos(48*std::acos(2*x2 - 1)) - 6.554201807348908e-10*std::cos(49*std::acos(2*x2 - 1)) + 1.7764133177308864e-9*std::cos(50*std::acos(2*x2 - 1)) - 2.0367941121205667e-9*std::cos(51*std::acos(2*x2 - 1)) + 1.8216315532900777e-9*std::cos(52*std::acos(2*x2 - 1)) - 1.4047154514692759e-9*std::cos(53*std::acos(2*x2 - 1)) + 9.574737232919425e-10*std::cos(54*std::acos(2*x2 - 1)) - 5.7090005701761315e-10*std::cos(55*std::acos(2*x2 - 1)) + 2.8023937538760341e-10*std::cos(56*std::acos(2*x2 - 1)) - 8.684412306614077e-11*std::cos(57*std::acos(2*x2 - 1)) - 2.5117297034129721e-11*std::cos(58*std::acos(2*x2 - 1)) + 7.7376565477746444e-11*std::cos(59*std::acos(2*x2 - 1)) - 9.0928489897026415e-11*std::cos(60*std::acos(2*x2 - 1)) + 8.2830808646356308e-11*std::cos(61*std::acos(2*x2 - 1)) - 6.5281052041408021e-11*std::cos(62*std::acos(2*x2 - 1)) + 4.5980615325295334e-11*std::cos(63*std::acos(2*x2 - 1)) - 2.9070121379615993e-11*std::cos(64*std::acos(2*x2 - 1)) + 1.6210489392487338e-11*std::cos(65*std::acos(2*x2 - 1)) - 7.5478715797212197e-12*std::cos(66*std::acos(2*x2 - 1)) + 2.4466243623355599e-12*std::cos(67*std::acos(2*x2 - 1)) + 1.6599702949215624e-14*std::cos(68*std::acos(2*x2 - 1)) - 7.4437514523889918e-13*std::cos(69*std::acos(2*x2 - 1)) + 4.7498761712286245e-13*std::cos(70*std::acos(2*x2 - 1)) + 2.6157904599333133e-13*std::cos(71*std::acos(2*x2 - 1)) - 1.1362195315727084e-12*std::cos(72*std::acos(2*x2 - 1)) + 1.9712637967856452e-12*std::cos(73*std::acos(2*x2 - 1)) - 2.6951824627254504e-12*std::cos(74*std::acos(2*x2 - 1)) + 3.3010552171258777e-12*std::cos(75*std::acos(2*x2 - 1)) - 3.7969664991766735e-12*std::cos(76*std::acos(2*x2 - 1)) + 4.1860477312803472e-12*std::cos(77*std::acos(2*x2 - 1)) - 4.4430351799358817e-12*std::cos(78*std::acos(2*x2 - 1)) + 4.5117575533004845e-12*std::cos(79*std::acos(2*x2 - 1)) - 4.3087079616314896e-12*std::cos(80*std::acos(2*x2 - 1)) + 3.7399841351872708e-12*std::cos(81*std::acos(2*x2 - 1)) - 2.7311687254707397e-12*std::cos(82*std::acos(2*x2 - 1)) + 1.2723329520596104e-12*std::cos(83*std::acos(2*x2 - 1)) + 5.3754992796632806e-13*std::cos(84*std::acos(2*x2 - 1)) - 2.4443188039482025e-12*std::cos(85*std::acos(2*x2 - 1)) + 4.0197349396301277e-12*std::cos(86*std::acos(2*x2 - 1)) - 4.6853919980961344e-12*std::cos(87*std::acos(2*x2 - 1)) + 3.7870459195600376e-12*std::cos(88*std::acos(2*x2 - 1)) - 7.4331602179923596e-13*std::cos(89*std::acos(2*x2 - 1)) - 4.7410350095307792e-12*std::cos(90*std::acos(2*x2 - 1)) + 1.2463754132728568e-11*std::cos(91*std::acos(2*x2 - 1)) - 2.1564614198980722e-11*std::cos(92*std::acos(2*x2 - 1)) + 3.0515935499642643e-11*std::cos(93*std::acos(2*x2 - 1)) - 3.7342740792298389e-11*std::cos(94*std::acos(2*x2 - 1)) + 4.0069183601227282e-11*std::cos(95*std::acos(2*x2 - 1)) - 3.7302794200522675e-11*std::cos(96*std::acos(2*x2 - 1)) + 2.8768193942809261e-11*std::cos(97*std::acos(2*x2 - 1)) - 1.5562891259800138e-11*std::cos(98*std::acos(2*x2 - 1)) + 1.2549182098300516e-17*std::cos(99*std::acos(2*x2 - 1)) + 0.0093335199638682736;
        
        
        V = 0.25*lambda*std::pow(eta,4)*std::pow((QF*QF-1),2);
        A = eta*eta/(r*r)*(QF*QF*(1-QA)*(1-QA) + r*r*QDF*QDF);
        B = QDA*QDA/(2*e*e*r*r);
        }
        
        else
        {
        V = 0;
        A = 0;
        B = 0;
        }
        
        amrex::Real Mloop = 4*M_PI*M_PI*eta*eta*R;
        
        amrex::Real X = 4*rdomain*R/((R+rdomain)*(R+rdomain)+z*z);
        
        amrex::Real EllipticK = 1.0/(0.6371443469957234 - 0.3825090269506524*X + 21.921322550349185*std::pow(X,2) - 931.2201854752086*std::pow(X,3) + 21593.522426738647*std::pow(X,4) - 
   310496.5476210054*std::pow(X,5) + 2.9840273650061437e6*std::pow(X,6) - 2.010319547286518e7*std::pow(X,7) + 9.78522018342169e7*std::pow(X,8) - 
   3.500343127111068e8*std::pow(X,9) + 9.242750865964419e8*std::pow(X,10) - 1.7795722183889222e9*std::pow(X,11) + 2.3871298092502055e9*std::pow(X,12) - 
   1.9037402556133525e9*std::pow(X,13) + 9.978136154009144e7*std::pow(X,14) + 1.9691416240251522e9*std::pow(X,15) - 2.83439763169519e9*std::pow(X,16) + 
   2.194551631063839e9*std::pow(X,17) - 1.0339954636084697e9*std::pow(X,18) + 2.801162579007364e8*std::pow(X,19) - 3.369910980958211e7*std::pow(X,20));
        
        u = Mloop/(4*M_PI*R)*4*R/std::sqrt((R+rdomain)*(R+rdomain)+z*z)*EllipticK;
        
        state_fab(i, j, k, Idx::V) = V;
        state_fab(i, j, k, Idx::A) = A;
        state_fab(i, j, k, Idx::B) = B;
        
        
        //amrex::Real rho = V+A+B;
        
        
        state_fab(i, j, k, Idx::u) = u;
        state_fab(i, j, k, Idx::chi) = std::pow(1+u,-4);
        
}
#endif